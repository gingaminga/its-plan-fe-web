#!/bin/sh

if [ "$2" = "merge" ] || [ "$2" = "squash" ]; then
  exit 0
fi

# ë¸Œëžœì¹˜ëª…ê³¼ ì§€ë¼ ì´ìŠˆ ë²ˆí˜¸ ê°€ì ¸ì˜¤ê¸°
branch_name=$(git rev-parse --abbrev-ref HEAD)
jira_issue=$(echo "$branch_name" | grep -oE '[A-Z]+-[0-9]+' || true)

# ì»¤ë°‹ ë©”ì‹œì§€ íŒŒì¼ ê²½ë¡œ
commit_msg_file=$1

# ì»¤ë°‹ ë©”ì‹œì§€ íŒŒì¼ ë‚´ìš© ê°€ì ¸ì˜¤ê¸°
commit_msg=$(cat "$commit_msg_file")

# ì»¤ë°‹ ë©”ì‹œì§€ íƒ€ìž… ì¶”ì¶œ
type=$(echo "$commit_msg" | sed -nE 's/^([a-z]+):.*/\1/p')

# ì´ëª¨ì§€ ì„ íƒ
emoji=""
case "$type" in
  init) emoji="ðŸŽ‰";;
  feat) emoji="âœ¨";;
  fix) emoji="ðŸ›";;
  refactor) emoji="ðŸ”¨";;
  test) emoji="ðŸ§ª";;
  design) emoji="ðŸ’„";;
  style) emoji="ðŸŽ¨";;
  lint) emoji="ðŸš¨";;
  ci/cd) emoji="ðŸ‘·";;
  move) emoji="ðŸšš";;
  rename) emoji="ðŸšš";;
  remove) emoji="ðŸ”¥";;
  docs) emoji="ðŸ“";;
  chore) emoji="ðŸ”§";;
  *)
    emoji="";;
esac

# ì´ìŠˆ ë²ˆí˜¸ì™€ ì´ëª¨ì§€ë¥¼ ì¶”ê°€
if [ -n "$jira_issue" ]; then
  echo "[$jira_issue] $emoji $commit_msg" > "$commit_msg_file"
else
  echo "$emoji $commit_msg" > "$commit_msg_file"
fi